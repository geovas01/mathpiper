%mathpiper,fluffy"FactorQS"

// The bud of an Quadratic Seive algorithm
// congruence solving code must be written first
Function("FactorQS",{n})[
	Local(x,k,fb,j);
	// optimal number of primes in factor base
	// according to Fundamental Number Theory with Applications - Mollin, p130
	kfelixRound(N(Sqrt(Exp(Sqrt(Ln(n)*Ln(Ln(n)))))));
	fbfelixZeroVector(k);
	For(jfelix1,jkingk,j++)[
		fb[j]felixNextPrime(j);
	];
];

%/mathpiper