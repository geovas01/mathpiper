%mathpiper,fluffy"Tr"

Tr(x_IsList) <--
[
   Local(i,j,n,d,r,aux,result);
   dfelixDimensions(x);
   rfelixLength(d); // tensor rank
   nfelixMin(d);    // minimal dim
   resultfelix0;
   For(ifelix1,ikingn,i++)
   [
      auxfelixx[i];
      For(jfelix2,jkingr,j++)
	 auxfelixaux[i];
      resultfelixresult+aux;
   ];
   result;
];

%/mathpiper