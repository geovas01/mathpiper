%mathpiper,title="TestFactors"

//########################################################################
//       T E S T I N G     T E S T I N G     T E S T I N G
//########################################################################

// a bunch of expressions for testing
expressions := {};
Push( expressions, {24,{{2,3},{3,1}}} );
Push( expressions, {-7*x-14*y,{{-7,1},{x+2*y,1}} } );
Push( expressions, {x^2-4,{{x+2,1},{x-2,1}}} );
Push( expressions, {x^2+2*x+1,{{x+1,2}}} );
Push( expressions, {-9*x^2+45*x-36,{{-9,1},{x-4,1},{x-1,1}}} );
Push( expressions, {x^2-a^2,{{x+a,1},{x-a,1}}} );
Push( expressions, {9*x^2-1,{{3*x-1,1},{3*x+1,1}}} );
Push( expressions, {x^3-y^3,{{x-y,1},{x^2+x*y+y^2,1}}} );
Push( expressions, {4*x^3+12*x^2-40*x,{{4,1},{x+5,1},{x-2,1},{x,1}}} );
Push( expressions, {32*x^3+32*x^2-70*x-75,{{4*x+5,2},{2*x-3,1}}} );
Push( expressions, {3*x^3-12*x^2-2*x+8,{{3*x^2-2,1},{x-4,1}}} );
Push( expressions, {x^3+3*x^2-25*x-75,{{x-5,1},{x+5,1},{x+3,1}}} );
Push( expressions, {2*x^3-30*x^2+12*x^4,{{2,1},{x,2},{3*x+5,1},{2*x-3,1}}} );
Push( expressions, {5*x^7-20*x^6+25*x^5-20*x^4+25*x^3-20*x^2+20*x,{{5,1},{x,1},{x^2+x+1,1},{x^2-x+1,1},{x-2,2}}} );
Push( expressions, {(2/5)*x^2-2*x-(12/5), {{2/5,1},{x+1,1},{x-6,1}}} );
Push( expressions, {0.4*x^2-2*x-2.4, {{2/5,1},{x+1,1},{x-6,1}}} );
Push( expressions, {x^3+1, {{x+1,1},{x^2-x+1,1}}} );
Push( expressions, {x^4-1, {{x+1,1},{x-1,1},{x^2+1,1}}} );
Push( expressions, {x^5-1, {{x-1,1},{x^4+x^3+x^2+x+1,1}}} );
Push( expressions, {x^5+1, {{x+1,1},{x^4-x^3+x^2-x+1,1}}} );
Push( expressions, {x^3+a^3, {{x+a,1},{x^2-a*x+a^2,1}}} );
Push( expressions, {x^6-a^6, {{x+a,1},{x-a,1},{x^2+x*a+a^2,1},{x^2-x*a+a^2,1}}} );
Push( expressions, {9*x^2.0 -1,{{3*x-1,1},{3*x+1,1}}} );
Push( expressions, {G(157+28*I), {{Complex(5,2),1},{Complex(-29,6),1}}});
Push( expressions, {G(1), {}});	  // is this the correct behavior? why not {{}} or {{1,1}}?
Push( expressions, {G(-1), {}});  // is this the correct behavior?
Push( expressions, {G(I), {}});	  // is this the correct behavior?
Push( expressions, {G(0), {}});	  // is this the correct behavior?
Push( expressions, {G(2), {{Complex(1,1),1},{Complex(1,-1),1}}});
Push( expressions, {G(-2), {{Complex(1,1),1},{Complex(1,-1),1}}});
Push( expressions, {G(3), {{3,1}}});
Push( expressions, {G(3*I), {{3,1}}});
Push( expressions, {G(4), {{Complex(1,1),2},{Complex(1,-1),2}}});
Push( expressions, {G(-5*I), {{Complex(2,1),1},{Complex(2,-1),1}}});
Push( expressions, {G(Complex(1,1)^11*163^4),{{Complex(1,1),11},{163,4}}});

//Push( expressions, {,{{},{},{},{}}} );

NewLine(2);  Tell("TEST Factors() and GaussianFactors()");
expressions := Reverse(expressions);
Local(i);   i := 0;
ForEach(q,expressions)
[
    i := i + 1;     
    Check(i<40, ">>>>> FORCED STOP <<<<<");
    f := q[1];
    g := q[2];
    Tell("-------------------------------------------------------------------");
    Tell(i);
    If( q[1][0] != G,
       [
           Tell(">>> Test Factors() on polynomial: ",f);
           stk := {};
           r   := (Factors(f));
           SysOut("             Factors(f)=",r);
       ],
       [
           f := f[1];
           Tell(">>> Test GaussianFactors() on expression: ",f);
           stk := {};
           r   := GaussianFactors(f);
           SysOut("             GaussianFactors(f)=",r);
       ]
    );
    rmg := Simplify(Expand(UnFlatten(r-g,"+",0)));
    If( IsZero(rmg) Or IsZeroVector(rmg), 
           SysOut("             Answer is CORRECT"),
           SysOut("             Answer is WRONG:  it should be ",g)
       );
];

%/mathpiper

    %output,preserve="false"
      Result: True
      
      Side Effects:
      << TEST Factors() and GaussianFactors()>> 
      << ------------------------------------------------------------------->> 
      << 1 >> 
      << >>> Test Factors() on polynomial: >> f : 24 
                   Factors(f)={{2,3},{3,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 2 >> 
      << >>> Test Factors() on polynomial: >> f : -(7*x+14*y) 
                   Factors(f)={{-7,1},{x+2*y,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 3 >> 
      << >>> Test Factors() on polynomial: >> f : x^2-4 
                   Factors(f)={{x-2,1},{x+2,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 4 >> 
      << >>> Test Factors() on polynomial: >> f : x^2+2*x+1 
                   Factors(f)={{x+1,2}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 5 >> 
      << >>> Test Factors() on polynomial: >> f : 45*x-9*x^2-36 
                   Factors(f)={{-9,1},{x-1,1},{x-4,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 6 >> 
      << >>> Test Factors() on polynomial: >> f : x^2-a^2 
                   Factors(f)={{x+Sqrt(a^2),1},{x-Sqrt(a^2),1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 7 >> 
      << >>> Test Factors() on polynomial: >> f : 9*x^2-1 
                   Factors(f)={{3*x+1,1},{3*x-1,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 8 >> 
      << >>> Test Factors() on polynomial: >> f : x^3-y^3 
                   Factors(f)={{x-y,1},{x^2+y*x+y^2,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 9 >> 
      << >>> Test Factors() on polynomial: >> f : 4*x^3+12*x^2-40*x 
                   Factors(f)={{4,1},{x,1},{x-2,1},{x+5,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 10 >> 
      << >>> Test Factors() on polynomial: >> f : 32*x^3+32*x^2-70*x-75 
                   Factors(f)={{2*x-3,1},{4*x+5,2}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 11 >> 
      << >>> Test Factors() on polynomial: >> f : 3*x^3-12*x^2-2*x+8 
                   Factors(f)={{x-4,1},{3*x^2-2,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 12 >> 
      << >>> Test Factors() on polynomial: >> f : x^3+3*x^2-25*x-75 
                   Factors(f)={{x+3,1},{x+5,1},{x-5,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 13 >> 
      << >>> Test Factors() on polynomial: >> f : 2*x^3-30*x^2+12*x^4 
                   Factors(f)={{2,1},{x,2},{2*x-3,1},{3*x+5,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 14 >> 
      << >>> Test Factors() on polynomial: >> f : 5*x^7-20*x^6+25*x^5-20*x^4+25*x^3-20*x^2+20*x 
                   Factors(f)={{5,1},{x,1},{x-2,2},{x^2+x+1,1},{x^2-x+1,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 15 >> 
      << >>> Test Factors() on polynomial: >> f : (2*x^2)/5-2*x-12/5 
                   Factors(f)={{2/5,1},{x+1,1},{x-6,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 16 >> 
      << >>> Test Factors() on polynomial: >> f : 0.4*x^2-2*x-2.4 
                   Factors(f)={{2/5,1},{x+1,1},{x-6,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 17 >> 
      << >>> Test Factors() on polynomial: >> f : x^3+1 
                   Factors(f)={{x+1,1},{x^2-x+1,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 18 >> 
      << >>> Test Factors() on polynomial: >> f : x^4-1 
                   Factors(f)={{x+1,1},{x-1,1},{x^2+1,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 19 >> 
      << >>> Test Factors() on polynomial: >> f : x^5-1 
                   Factors(f)={{x-1,1},{x^4+x^3+x^2+x+1,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 20 >> 
      << >>> Test Factors() on polynomial: >> f : x^5+1 
                   Factors(f)={{x+1,1},{x^4-x^3+x^2-x+1,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 21 >> 
      << >>> Test Factors() on polynomial: >> f : x^3+a^3 
                   Factors(f)={{x+a,1},{x^2-a*x+a^2,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 22 >> 
      << >>> Test Factors() on polynomial: >> f : x^6-a^6 
                   Factors(f)={{x+a,1},{x-a,1},{x^2+x*a+a^2,1},{x^2-x*a+a^2,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 23 >> 
      << >>> Test Factors() on polynomial: >> f : 9*x^2.0-1 
                   Factors(f)={{9*x^2.0-1,1}}
                   Answer is WRONG:  it should be {{3*x-1,1},{3*x+1,1}}
      << ------------------------------------------------------------------->> 
      << 24 >> 
      << >>> Test GaussianFactors() on expression: >> f : Complex(157,28) 
                   GaussianFactors(f)={{Complex(5,2),1},{Complex(-29,6),1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 25 >> 
      << >>> Test GaussianFactors() on expression: >> f : 1 
                   GaussianFactors(f)={}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 26 >> 
      << >>> Test GaussianFactors() on expression: >> f : -1 
                   GaussianFactors(f)={}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 27 >> 
      << >>> Test GaussianFactors() on expression: >> f : Complex(0,1) 
                   GaussianFactors(f)={}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 28 >> 
      << >>> Test GaussianFactors() on expression: >> f : 0 
                   GaussianFactors(f)={}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 29 >> 
      << >>> Test GaussianFactors() on expression: >> f : 2 
                   GaussianFactors(f)={{Complex(1,1),1},{Complex(1,-1),1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 30 >> 
      << >>> Test GaussianFactors() on expression: >> f : -2 
                   GaussianFactors(f)={{Complex(1,1),1},{Complex(1,-1),1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 31 >> 
      << >>> Test GaussianFactors() on expression: >> f : 3 
                   GaussianFactors(f)={{3,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 32 >> 
      << >>> Test GaussianFactors() on expression: >> f : Complex(0,3) 
                   GaussianFactors(f)={{3,1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 33 >> 
      << >>> Test GaussianFactors() on expression: >> f : 4 
                   GaussianFactors(f)={{Complex(1,1),2},{Complex(1,-1),2}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 34 >> 
      << >>> Test GaussianFactors() on expression: >> f : Complex(0,-5) 
                   GaussianFactors(f)={{Complex(2,1),1},{Complex(2,-1),1}}
                   Answer is CORRECT
      << ------------------------------------------------------------------->> 
      << 35 >> 
      << >>> Test GaussianFactors() on expression: >> f : Complex(-22589176352,22589176352) 
                   GaussianFactors(f)={{Complex(1,1),11},{163,4}}
                   Answer is CORRECT
.   %/output










